// Refactored OAuth2 authentication for better performance